{% extends "sacrud/types/SacrudBase.jinja2" %}

{% block sacrud_column %}
    {% for rel in relationships %}
        {% if col in rel.local_columns %}
            <select class="sacrud_fk {{ css_styles }}"
                    id="sacrud_fk_{{ col.name }}" name="{{ col.name }}">
                <option></option>
                {% for x in session.query(rel.mapper) %}
                    {% set pk=x.__mapper__.primary_key[0].name %}
                    <option value='{{ getattr(x, pk) }}'
                        {% if obj %}
                            {% if value==getattr(x, pk) %}
                                selected
                            {% endif %}
                        {% endif %}>
                        {{ x.__repr__() }}
                    </option>
                {% endfor %}
            </select>
        {% endif %}
    {% endfor %}

    <script>
        $(document).ready(function () {
            $("#sacrud_fk_{{ col.name }}").chosen({
                width: "200px",
                no_results_text: "Не найдено",
            });
        });
    </script>

{% endblock %}
